<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Insert title here</title>
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.1/js/bootstrap.min.js"></script>
</head>
<body>
	<div class="container-fullwidth">
		<nav class="navbar navbar-dark bg-primary">
			<h1 class="text-light font-weight-bold">Contatti</h1>
			
			<form class="form-inline my-2 my-lg-0" onsubmit="return false;">
		      <input class="form-control mr-sm-2" type="search" placeholder="Ricerca" aria-label="Search" id="ricerca">
		      <button type="button" class="btn btn-success" id="bottone">Filtra</button>
		    </form>
		</nav>
	</div>
	
	<table class="table">
	  <thead align="center" class="thead-dark">
	    <tr>
	      <th scope="col">Cognome</th>
	      <th scope="col">Nome</th>
	      <th scope="col">Telefono</th>
	      <th scope="col">Email</th>
	      <th scope="col">indirizzo</th>
	      <th scope="col"></th>
	      <th scope="col"></th>
	    </tr>
	  </thead>
	  <tbody align="center" id="tabella">
	    <tr th:each="persona : ${persone}">
	      <td th:text="${persona.cognome}"></td>
	      <td th:text="${persona.nome}"></td>
	      <td th:text="${persona.telefono}"></td>
	      <td th:text="${persona.email}"></td>
	      <td th:text="${persona.indirizzo}"></td>
	      <td>
	      	<form th:action="@{/form_change}" th:object="${p}" method="post">
	      		 <input type="hidden" name="id" th:value="${persona.id}">
	      		 <input type="hidden" name="nome" th:value="${persona.nome}">
	      		 <input type="hidden" name="cognome" th:value="${persona.cognome}">
	      		 <input type="hidden" name="telefono" th:value="${persona.telefono}">
	      		 <input type="hidden" name="email" th:value="${persona.email}">
	      		 <input type="hidden" name="indirizzo" th:value="${persona.indirizzo}">
	      		 <button type="submit" class="btn btn-success text-light">Modifica</button>
	      	</form>
	      </td>
	      <td>
	      	<form th:action="@{/delete}" th:object="${p}" method="post">
	      		 <input type="hidden" name="id" th:value="${persona.id}">
	      		 <input type="hidden" name="nome" th:value="${persona.nome}">
	      		 <input type="hidden" name="cognome" th:value="${persona.cognome}">
	      		 <input type="hidden" name="telefono" th:value="${persona.telefono}">
	      		 <input type="hidden" name="email" th:value="${persona.email}">
	      		 <input type="hidden" name="indirizzo" th:value="${persona.indirizzo}">
	      		 <button type="submit" class="btn btn-danger text-light" id="elimina">Elimina</button>
	      	</form>
	      </td>
	    </tr>
	  </tbody>
	</table>
	
	<div align="center">
		<a href="/form" class="btn btn-success text-light" id="add">Aggiungi contatto</a>
	</div>
	
	<script type="text/javascript">
		$(document).ready(function(){
		  $("#bottone").on("click", function() {
		    var value = $("#ricerca").val().toLowerCase();
		    $("#tabella tr").filter(function() {
		      $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
		    });
		  });
		  $("#ricerca").on("keyup", function(event) {
			  if (event.keyCode == 13) {
			  	$("#bottone").click();
			  }
		  });
		  $(document).on("click", "#elimina", function() {
			  return confirm("Sei sicuro di voler eliminare questo contatto?");
		  });
		});
	</script>
</body>
</html>